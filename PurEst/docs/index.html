<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Method for calculating tumor purity and adjusting Illumina 450/850K DNA methylation beta values • PurEst</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Method for calculating tumor purity and adjusting Illumina 450/850K DNA methylation beta values">
<meta property="og:description" content="This package allows for the adjustment of DNA methylation beta values based on sample purity, to account for the effect of tumour composition in the experimentally determined beta values. Additionally, it allows for the estimation of sample purity from unadjusted beta values using reference data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">PurEst</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="purest">PurEst<a class="anchor" aria-label="anchor" href="#purest"></a>
</h1></div>
<p>Method for calculating tumor purity and adjusting Illumina 450/850K DNA methylation beta values. This work has been described in the article “<strong>Tumor purity estimated from bulk DNA methylation can be used for adjusting beta values of individual samples to better reflect tumor biology</strong>” published by <a href="LINK">Sasiain, Nacer et al. in <em>JOURNAL</em></a>.</p>
<div class="section level2">
<h2 id="framework">Framework<a class="anchor" aria-label="anchor" href="#framework"></a>
</h2>
<p>PurEst is divided into three main modules:</p>
<ol style="list-style-type: decimal">
<li>
<em>Creation of reference data from a cohort</em>: in this first module, reference linear regressions are calculated based on DNA methylation beta values and tumor purity estimates of a cohort. Each regression represents a sample population as shown in the figure below. Scripts used in this module: ref_regression_calculator.r (main), new_function_correctBetas.r.</li>
</ol>
<p align="center">
<img src="./reference/figures/module1.png" width="350"></p>
<ol start="2" style="list-style-type: decimal">
<li>
<em>Estimation of tumor purities for individual samples</em>: in this module, CpGs are filtered based on beta variance and then each CpG is processed individually per sample as shown in the figure below. Scripts used in this module: purity_estimator.r (main), predicting_purity.r, purity_coverage.r.</li>
</ol>
<div class="float">
<img src="./reference/figures/module2.png" title="PurEst Module 2" alt="Module 2"><div class="figcaption">Module 2</div>
</div>
<ol start="3" style="list-style-type: decimal">
<li>
<em>Adjustment of beta values per CpG per sample</em>: in this final module, beta values are adjusted for tumor cells and inferred for normal cells using the reference regressions and the estimated purities. This can be carried out after refitting the regressions to include the new data points with estimated purities or using the original reference regressions. Scripts used in this module: final_beta_correction.r (main), new_function_correctBetas.r.</li>
</ol>
<div class="float">
<img src="./reference/figures/module3.png" title="PurEst Module 3" alt="Module 3"><div class="figcaption">Module 3</div>
</div>
</div>
<div class="section level2">
<h2 id="how-to-use">How to use<a class="anchor" aria-label="anchor" href="#how-to-use"></a>
</h2>
<p>All scripts must be in the same folder. They should be called from the terminal following the commands below.</p>
<ul>
<li>ref_regression_calculator.r</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">Rscript</span> path_to_directory/ref_regression_calculator.r <span class="at">-c</span> <span class="pp">[</span><span class="ss">NUM_OF_CORES</span><span class="pp">]</span> <span class="at">-b</span> <span class="pp">[</span><span class="ss">INPUT_BETAS.rds</span><span class="pp">]</span> <span class="at">-p</span> <span class="pp">[</span><span class="ss">INPUT_PURITIES.rds</span><span class="pp">]</span> <span class="at">-o</span> <span class="pp">[</span><span class="ss">OUTPUT_PATH</span><span class="pp">]</span> <span class="at">-n</span> <span class="pp">[</span><span class="ss">OUTPUT_NAME</span><span class="pp">]</span></span></code></pre></div>
<p>INPUT_BETAS.rds: beta values per sample should be previously saved in .rds format. The file should contain a matrix with Illumina CpG identifiers as row names and samples as column names.<br>
INPUT_PURITIES.rds: a named vector with same sample names, also saved in .rds format.</p>
<ul>
<li>purity_estimator.r</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">Rscript</span> path_to_directory/purity_estimator.r <span class="at">-c</span> <span class="pp">[</span><span class="ss">NUM_OF_CORES</span><span class="pp">]</span> <span class="at">-a</span> <span class="pp">[</span><span class="ss">ALPHA_VALUE</span><span class="pp">]</span> <span class="at">-s</span> <span class="pp">[</span><span class="ss">SLOPE_THRESHOLD</span><span class="pp">]</span> <span class="at">-v</span> <span class="pp">[</span><span class="ss">VARIANCE_THRESHOLD</span><span class="pp">]</span> <span class="at">-p</span> <span class="pp">[</span><span class="ss">PERCENTAGE_TO_INTERVAL</span><span class="pp">]</span> <span class="at">-d</span> <span class="pp">[</span><span class="ss">REGRESSIONS_DIRECTORY</span><span class="pp">]</span> <span class="at">-b</span> <span class="pp">[</span><span class="ss">BETAS_TO_ANALYSE</span><span class="pp">]</span> <span class="at">-o</span> <span class="pp">[</span><span class="ss">OUTPUT_NAME</span><span class="pp">]</span></span></code></pre></div>
<ul>
<li>final_beta_correction.r</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">RScript</span> path_to_directory/final_beta_correction.r <span class="at">-c</span> <span class="pp">[</span><span class="ss">CORES</span><span class="pp">]</span> <span class="at">-r</span> [refitting: TRUE/FALSE] <span class="at">-R</span> <span class="pp">[</span><span class="ss">PATH_TO_REF_REGRESSIONS</span><span class="pp">]</span> <span class="at">-P</span> <span class="pp">[</span><span class="ss">REF_COHORT_PURITY</span><span class="pp">]</span> <span class="at">-B</span> <span class="pp">[</span><span class="ss">REF_COHORT_BETAS</span><span class="pp">]</span> <span class="at">-p</span> <span class="pp">[</span><span class="ss">ESTIMATED_PURITIES</span><span class="pp">]</span> <span class="at">-b</span> <span class="pp">[</span><span class="ss">BETAS_TO_CORRECT</span><span class="pp">]</span> <span class="at">-F</span> [CORRECT_CERTAIN_CPGS: TRUE/FALSE] <span class="at">-f</span> <span class="pp">[</span><span class="ss">CPGS_TO_CORRECT</span><span class="pp">]</span> <span class="at">-o</span> <span class="pp">[</span><span class="ss">OUTPUT_PATH</span><span class="pp">]</span> <span class="at">-n</span> <span class="pp">[</span><span class="ss">OUTPUT_NAME</span><span class="pp">]</span></span></code></pre></div>
<blockquote>
<p>NOTE: A more detailed explanation of how to use any script is available in each script’s documentation at the top of the file, or by running the scripts with the -h flag.</p>
</blockquote>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">RScript</span> path_to_scripts_folder/final_beta_correction.r <span class="at">-h</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reference-data">Reference data<a class="anchor" aria-label="anchor" href="#reference-data"></a>
</h2>
<p>Beta values, beta variance, reference regression information, and purity estimates for TCGA BRCA (n=630 samples), TCGA LUAD (n=418), and TCGA LUSC (n=333) are available in FigShare through <a href="https://doi.org/10.6084/m9.figshare.25074098" class="external-link">this DOI</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing PurEst</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Iñaki Sasiain Casado <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Iñaki Sasiain Casado.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
